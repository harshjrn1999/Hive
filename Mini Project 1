Problem Statemnt : - 

You have to perform hive analysis on this given dataset.

Download Dataset 1 - https://drive.google.com/file/d/1WrG-9qv6atP-W3P_-gYln1hHyFKRKMHP/view

Download Dataset 2 - https://drive.google.com/file/d/1-JIPCZ34dyN6k9CqJa-Y8yxIGq6vTVXU/view

Note: both files are csv files.

use hive_class_b4;

create table agent(s1_no int, agent string, creation_data string, login_time string, logout_time string, duration string) row format delimited fields terminated by ','  tblproperties('skip.header.line.count' = '1');

create table agents(s1_no int, date string, agent_name string, Total_Chats int, Average_Response_Time string, Average_Resolution_Time string, Average_Rating float,Total_Feedback int) row format delimited fields terminated by ','  tblproperties('skip.header.line.count' = '1');

set hive.cli.print.header = true;

load data local inpath 'file:///tmp/hive_class/AgentPerformance.csv' into table agents;

load data local inpath 'file:///tmp/hive_class/AgentLogingReport.csv' into table agent;

3. List of all agents' names.

select agent_name from agents;

Uday Mishra
Aditya_iot
Nishtha Jain
Aditya Shinde
Hyder Abbas
Prabir Kumar Satapathy
Bharath
Deepranjan Gupta
Abhishek
Rishav Dash
Ankit Sharma
Samprit
Wasim
Muskan Garg
Aravind
Ashad Nasim
Vasanth P
Amersh
Ineuron Intelligence
Ishawant Kumar
Sandipan Saha
Mahak
Ameya Jain
Mukesh Rao
Zeeshan
Aditya
Ankitjha
Saif Khan
Anurag Tiwari
Maneesh
Harikrishnan Shaji
Ashish
Prateek _iot
Rohan
Saikumarreddy N
Sudhanshu Kumar
Spuri
Suraj S Bilgi
Nandani Gupta
Shivan_S
Mahesh Sarade
Sowmiya Sivakumar
Nitin M
Vivek
Ayushi Mishra
Chaitra K Hiremath
Time taken: 0.079 seconds, Fetched: 2160 row(s)

4. Find out agent average rating.

select avg(Average_Rating) as rating from agents;

rating
1.4609629649255012

6. Total query that each agent have taken

1706    0
1707    0
1708    0
1709    0
1710    0
1711    0
1712    0
1713    0
1714    0
1715    0
1716    0
1717    0
1718    0
1719    0
1720    0
1721    0
1722    0
1723    0
1724    6
1725    17
1726    8
1727    15
1728    20
1729    12
1730    8
1731    14
1732    1
1733    7
1734    20
1735    17
1736    15
1737    18
1738    15
1739    29
1740    1
1741    1
1742    23


7. Total Feedback that each agent have received 
1869    13
1870    18
1871    15
1872    13
1873    2
1874    12
1875    20
1876    14
1877    15
1878    2
1879    18
1880    10
1881    17
1882    9
1883    9
1884    12
1885    26
1886    0
1887    0
1888    0
1889    0
1890    0
1891    0

8. Agent name who have average rating between 3.5 to 4 
Aditya_iot      3.83
Maitry  3.92
Shivananda Sonwane      3.71
Ameya Jain      4.0
Swati   4.0
Ashad Nasim     4.0
Prabir Kumar Satapathy  4.0
Boktiar Ahmed Bappy     3.78
Nishtha Jain    4.0
Ayushi Mishra   3.8
Shivan K        4.0
Shubham Sharma  4.0
Jawala Prakash  3.8
Sanjeev Kumar   4.0
Aditya Shinde   3.54
Deepranjan Gupta        3.71
Sanjeev Kumar   4.0
Time taken: 0.121 seconds, Fetched: 228 row(s)

9. Agent name who have rating less than 3.5 

agent_name      average_rating
Nandani Gupta   3.14
Hitesh Choudhary        0.0
Sanjeevan       0.0
Anirudh         0.0
Shiva Srivastava        0.0
Dibyanshu       0.0
Ashish  0.0
Uday Mishra     0.0
Aditya Shinde   0.0
Jayant Kumar    0.0
Aditya_iot      0.0
Prabir Kumar Satapathy  0.0
Saurabh Shukla  0.0
Wasim   0.0

10. Agent name who have rating more than 4.5 

select agent_name, Average_Rating from agents where Average_Rating > 4.5 

agent_name      average_rating
Ameya Jain      4.55
Mahesh Sarade   4.71
Mukesh  4.62
Saikumarreddy N 5.0
Sanjeev Kumar   5.0
Harikrishnan Shaji      4.57
Sowmiya Sivakumar       4.75
Boktiar Ahmed Bappy     4.75
Shivananda Sonwane      5.0
Ishawant Kumar  4.67
Deepranjan Gupta        4.8
Shivananda Sonwane      4.67
Muskan Garg     5.0
Aditya_iot      4.6
Mukesh  4.67

11. How many feedback agents have received more than 4.5 average

select  count(Average_Rating) as total  from agents where Average_Rating > 4.5;

total
614

12. average weekly response time for each agent 



